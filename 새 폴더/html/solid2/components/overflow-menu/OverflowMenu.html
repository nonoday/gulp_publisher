<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OverflowMenu Component</title>
    <style>
/* Demo container styles */
.demo-container {
  padding: 20px;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
}

.demo-section {
  margin-bottom: 30px;
}

.demo-section h3 {
  margin-bottom: 15px;
  color: #333;
  font-size: 18px;
  font-weight: 600;
}

.demo-row {
  margin-bottom: 20px;
  padding: 20px;
  background-color: #f8f9fa;
  border-radius: 8px;
  position: relative;
}

.demo-label {
  display: block;
  margin-bottom: 10px;
  font-size: 14px;
  color: #666;
  font-weight: 500;
}

/* Trigger button styles */
.trigger-button {
  background-color: #007bff;
  color: white;
  border: none;
  padding: 8px 16px;
  border-radius: 6px;
  cursor: pointer;
  font-size: 14px;
  margin-bottom: 10px;
}

.trigger-button:hover {
  background-color: #0056b3;
}

.trigger-button:active {
  background-color: #004085;
}

/* Interactive demo */
.interactive-demo {
  position: relative;
  min-height: 200px;
}

/* Responsive adjustments */
@media (max-width: 768px) {
  .demo-row {
    padding: 15px;
  }
}
    </style>
</head>
<body>
    <div class="demo-container">
        <h1>OverflowMenu Component</h1>
        
        <!-- Basic OverflowMenu -->
        <div class="demo-section">
            <h3>Basic OverflowMenu</h3>
            
            <div class="demo-row">
                <span class="demo-label">Default OverflowMenu</span>
                <button class="trigger-button" id="trigger1">메뉴 열기</button>
                <overflow-menu-component id="menu1" placement="bottom-right"></overflow-menu-component>
            </div>
        </div>
        
        <!-- Placement Variants -->
        <div class="demo-section">
            <h3>Placement Variants</h3>
            
            <div class="demo-row">
                <span class="demo-label">Top Placements</span>
                <div style="display: flex; gap: 10px; margin-bottom: 10px;">
                    <button class="trigger-button" id="trigger2">Top Left</button>
                    <button class="trigger-button" id="trigger3">Top Center</button>
                    <button class="trigger-button" id="trigger4">Top Right</button>
                </div>
                
                <overflow-menu-component id="menu2" placement="top-left"></overflow-menu-component>
                <overflow-menu-component id="menu3" placement="top-center"></overflow-menu-component>
                <overflow-menu-component id="menu4" placement="top-right"></overflow-menu-component>
            </div>
            
            <div class="demo-row">
                <span class="demo-label">Bottom Placements</span>
                <div style="display: flex; gap: 10px; margin-bottom: 10px;">
                    <button class="trigger-button" id="trigger5">Bottom Left</button>
                    <button class="trigger-button" id="trigger6">Bottom Center</button>
                    <button class="trigger-button" id="trigger7">Bottom Right</button>
                </div>
                
                <overflow-menu-component id="menu5" placement="bottom-left"></overflow-menu-component>
                <overflow-menu-component id="menu6" placement="bottom-center"></overflow-menu-component>
                <overflow-menu-component id="menu7" placement="bottom-right"></overflow-menu-component>
            </div>
        </div>
        
        <!-- Menu Item Variants -->
        <div class="demo-section">
            <h3>Menu Item Variants</h3>
            
            <div class="demo-row">
                <span class="demo-label">Different Menu Item Types</span>
                <button class="trigger-button" id="trigger8">메뉴 아이템 보기</button>
                <overflow-menu-component id="menu8" placement="bottom-right"></overflow-menu-component>
            </div>
        </div>
        
        <!-- Max Width Behavior -->
        <div class="demo-section">
            <h3>Max Width Behavior</h3>
            
            <div class="demo-row">
                <span class="demo-label">Long Text Menu (Max Width Reached)</span>
                <button class="trigger-button" id="trigger9">긴 텍스트 메뉴</button>
                <overflow-menu-component id="menu9" placement="bottom-right" max-width="true"></overflow-menu-component>
            </div>
        </div>
        
        <!-- Interactive Demo -->
        <div class="demo-section">
            <h3>Interactive Demo</h3>
            
            <div class="demo-row interactive-demo">
                <span class="demo-label">클릭하여 메뉴 위치 변경</span>
                <button class="trigger-button" id="trigger10">인터랙티브 메뉴</button>
                <overflow-menu-component id="menu10" placement="bottom-right"></overflow-menu-component>
            </div>
        </div>
    </div>

    <script>
        // 스크립트 로딩 완료 후 초기화
        function initializeAfterScriptLoad() {
            console.log('스크립트 로딩 완료, 초기화 시작');
            initializeOverflowMenus();
        }
        
        // 스크립트 로딩 실패 처리
        function handleScriptError() {
            console.error('스크립트 로딩 실패, 절대 경로로 재시도');
            // 절대 경로로 재시도
            const script = document.createElement('script');
            script.src = '/script/components/overflow-menu/overflow-menu-component.js';
            script.onload = initializeAfterScriptLoad;
            script.onerror = () => console.error('절대 경로로도 스크립트 로딩 실패');
            document.head.appendChild(script);
        }
    </script>
    
    <script src="../../../script/components/overflow-menu/overflow-menu-component.js" 
            onerror="handleScriptError()"
            onload="initializeAfterScriptLoad()"></script>
    
    <script>
        // DOM 로드 완료 후에도 초기화 시도
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM 로드 완료');
            // 스크립트가 이미 로드되었다면 바로 초기화
            if (customElements.get('overflow-menu-component')) {
                console.log('웹컴포넌트 이미 정의됨, 초기화 시작');
                initializeOverflowMenus();
            }
        });

        function initializeOverflowMenus() {
            console.log('OverflowMenu 초기화 함수 실행');
            
            // 웹컴포넌트가 정의되었는지 확인
            if (!customElements.get('overflow-menu-component')) {
                console.error('OverflowMenuComponent가 정의되지 않았습니다.');
                return;
            }
            
            // 기본 메뉴들 초기화
            const menu1 = document.getElementById('menu1');
            const trigger1 = document.getElementById('trigger1');
            console.log('menu1:', menu1, 'trigger1:', trigger1);
            console.log('menu1의 setTriggerElement 메서드:', typeof menu1?.setTriggerElement);
            
            if (menu1 && trigger1 && typeof menu1.setTriggerElement === 'function') {
                menu1.setTriggerElement(trigger1);
                console.log('menu1 트리거 설정 완료');
            } else {
                console.error('menu1 또는 trigger1을 찾을 수 없거나 setTriggerElement 메서드가 없습니다.');
            }

            // 다른 메뉴들도 동일하게 초기화
            const menuTriggerPairs = [
                ['menu2', 'trigger2'],
                ['menu3', 'trigger3'],
                ['menu4', 'trigger4'],
                ['menu5', 'trigger5'],
                ['menu6', 'trigger6'],
                ['menu7', 'trigger7'],
                ['menu8', 'trigger8'],
                ['menu9', 'trigger9'],
                ['menu10', 'trigger10']
            ];

            menuTriggerPairs.forEach(([menuId, triggerId]) => {
                const menu = document.getElementById(menuId);
                const trigger = document.getElementById(triggerId);
                console.log(`${menuId}:`, menu, `${triggerId}:`, trigger);
                
                if (menu && trigger && typeof menu.setTriggerElement === 'function') {
                    menu.setTriggerElement(trigger);
                    console.log(`${menuId} 트리거 설정 완료`);
                } else {
                    console.error(`${menuId} 또는 ${triggerId}를 찾을 수 없거나 setTriggerElement 메서드가 없습니다.`);
                }
            });

            // 각 메뉴에 적절한 메뉴 아이템 설정
            const menu8 = document.getElementById('menu8');
            if (menu8) {
                menu8.setMenuItems([
                    { text: '폴더 열기', icon: '📁' },
                    { text: '저장', icon: '💾' },
                    { text: '새로고침', icon: '🔄' },
                    { type: 'divider' },
                    { text: '설정', icon: '⚙️' },
                    { text: '비활성화', icon: '🚫', danger: true },
                    { type: 'divider' },
                    { text: '잠금 (비활성화)', icon: '🔒', disabled: true }
                ]);
            }

            // 인터랙티브 메뉴 설정
            const interactiveMenu = document.getElementById('menu10');
            if (interactiveMenu) {
                interactiveMenu.setMenuItems([
                    { text: 'Top Left로 이동', icon: '⬆️' },
                    { text: 'Top Center로 이동', icon: '⬆️' },
                    { text: 'Top Right로 이동', icon: '⬆️' },
                    { type: 'divider' },
                    { text: 'Bottom Left로 이동', icon: '⬇️' },
                    { text: 'Bottom Center로 이동', icon: '⬇️' },
                    { text: 'Bottom Right로 이동', icon: '⬇️' }
                ]);
            }

            // 긴 텍스트 메뉴 설정
            const longTextMenu = document.getElementById('menu9');
            if (longTextMenu) {
                longTextMenu.setMenuItems([
                    { text: '매우 긴 메뉴 아이템 텍스트가 여기에 표시됩니다' },
                    { text: '또 다른 긴 메뉴 아이템 텍스트입니다' },
                    { text: '세 번째 긴 메뉴 아이템 텍스트입니다' }
                ]);
            }

            // 메뉴 아이템 클릭 이벤트 리스너
            document.addEventListener('menu-item-click', function(event) {
                console.log('메뉴 아이템 클릭됨:', event.detail.text);
                
                // 인터랙티브 메뉴의 위치 변경 기능
                if (event.detail.text.includes('이동')) {
                    const placement = event.detail.text.split(' ')[0].toLowerCase().replace('로', '');
                    changeMenuPlacement('menu10', placement);
                }
            });
        }

        // 메뉴 위치 변경 함수
        function changeMenuPlacement(menuId, placement) {
            const menu = document.getElementById(menuId);
            if (menu) {
                menu.placement = placement;
            }
        }
    </script>
</body>
</html>
