<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>InputField Web Component</title>
    <style>
        /* 기본 InputField 스타일 */
        .sv-input-field {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            width: 100%;
        }

        .sv-input-field__container {
            display: flex;
            gap: 0;
            align-items: center;
            width: 100%;
        }

        .sv-input-field__item-wrapper {
            position: relative;
            display: flex;
            align-items: center;
            flex: 1;
            gap: 0.25rem;
            padding: 0.75rem 1rem;
            border: none;
            background: transparent;
            transition: all 0.2s ease-in-out;
        }

        .sv-input-field__item-group {
            display: flex;
            flex-direction: column;
            flex: 1;
            gap: 0.25rem;
        }

        .sv-input-field__item-alt-present {
            font-size: 0.75rem;
            line-height: 1.2;
            color: #6b7280;
            margin-top: 0.125rem;
        }

        .sv-input-field__item {
            border: none;
            outline: none;
            background: transparent;
            font-size: 1rem;
            line-height: 1.5;
            color: inherit;
            flex: 1;
            min-width: 0;
        }

        .sv-input-field__item::placeholder {
            color: #9ca3af;
        }

        .sv-input-field__item--align-start {
            text-align: start;
        }

        .sv-input-field__item--align-end {
            text-align: end;
        }

        .sv-input-field__start-icon,
        .sv-input-field__start-text {
            flex-shrink: 0;
            color: #6b7280;
        }

        .sv-input-field__start-text {
            font-size: 1rem;
            line-height: 1.5;
        }

        .sv-input-field__end-icon,
        .sv-input-field__end-text {
            flex-shrink: 0;
            color: #6b7280;
        }

        .sv-input-field__end-text {
            font-size: 1rem;
            line-height: 1.5;
        }

        .sv-input-field__clear-button {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0.25rem;
            border: none;
            background: transparent;
            border-radius: 0.25rem;
            cursor: pointer;
            color: #6b7280;
            transition: color 0.2s ease-in-out;
        }

        .sv-input-field__clear-button:hover {
            color: #111827;
        }

        .sv-input-field__end-adornment,
        .sv-input-field__button-slot {
            flex-shrink: 0;
        }

        .sv-input-field__alt-present {
            font-size: 0.875rem;
            line-height: 1.25;
            color: #6b7280;
            margin-top: 0.25rem;
        }

        .sv-input-field__description {
            font-size: 0.875rem;
            line-height: 1.25;
            color: #6b7280;
        }

        .sv-input-field__error-message {
            font-size: 0.875rem;
            line-height: 1.25;
            color: #ef4444;
        }

        /* Variant styles */
        .sv-input-field--variant-outline .sv-input-field__container {
            border: 1px solid #d1d5db;
            border-radius: 0.375rem;
            background: #ffffff;
        }

        .sv-input-field--variant-outline .sv-input-field__container:focus-within {
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .sv-input-field--variant-underline .sv-input-field__container {
            border-bottom: 1px solid #d1d5db;
            padding-bottom: 0.5rem;
        }

        .sv-input-field--variant-underline .sv-input-field__container:focus-within {
            border-bottom-color: #3b82f6;
        }

        .sv-input-field--variant-underline .sv-input-field__item-wrapper {
            padding-left: 0;
            padding-right: 0;
        }

        /* State modifiers */
        .sv-input-field--disabled {
            opacity: 0.6;
            pointer-events: none;
        }

        .sv-input-field--disabled.sv-input-field--variant-outline .sv-input-field__container {
            background-color: #f3f4f6;
        }

        .sv-input-field--disabled .sv-input-field__item {
            cursor: not-allowed;
        }

        .sv-input-field--error.sv-input-field--variant-outline .sv-input-field__container {
            border-color: #ef4444;
        }

        .sv-input-field--error.sv-input-field--variant-outline .sv-input-field__container:focus-within {
            border-color: #ef4444;
            box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.1);
        }

        .sv-input-field--error.sv-input-field--variant-underline .sv-input-field__container {
            border-bottom-color: #ef4444;
        }

        .sv-input-field--error.sv-input-field--variant-underline .sv-input-field__container:focus-within {
            border-bottom-color: #ef4444;
        }

        .sv-input-field--required .sv-input-field__item-wrapper::after {
            content: '*';
            color: #ef4444;
            margin-left: 0.25rem;
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .sv-input-field__container {
                flex-direction: column;
                gap: 0.75rem;
            }
        }

        /* 접근성을 위한 포커스 스타일 */
        .sv-input-field__item:focus-visible {
            outline: 2px solid #3b82f6;
            outline-offset: 2px;
        }

        .sv-input-field__clear-button:focus-visible {
            outline: 2px solid #3b82f6;
            outline-offset: 2px;
        }

        /* 고대비 모드 지원 */
        @media (prefers-contrast: high) {
            .sv-input-field__item {
                border: 1px solid #000;
            }
            
            .sv-input-field__clear-button {
                border: 1px solid #000;
            }
        }

        /* 모션 감소 지원 */
        @media (prefers-reduced-motion: reduce) {
            .sv-input-field__item-wrapper,
            .sv-input-field__clear-button {
                transition: none;
            }
        }

        /* 슬롯 스타일 */
        .sv-input-field__start-dropbox,
        .sv-input-field__end-dropbox {
            flex-shrink: 0;
        }

        /* 아이콘 스타일 */
        .sv-input-field__start-icon,
        .sv-input-field__end-icon {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 1.5rem;
            height: 1.5rem;
        }
    </style>
</head>
<body>
    <!-- 웹컴포넌트 정의 -->
    <script>
        class InputFieldComponent extends HTMLElement {
            constructor() {
                super();
                this.attachShadow({ mode: 'open' });
                this._inputItems = [];
                this._startIcon = '';
                this._startText = '';
                this._endIcon = '';
                this._endText = '';
                this._placeholder = '';
                this._description = '';
                this._altPresent = '';
                this._showClear = true;
                this._errorMessage = '';
                this._variant = 'underline';
                this._disabled = false;
                this._error = false;
                this._required = false;
                this._align = 'start';
                this._fieldValues = {};
                this._isFocused = false;
                this._ariaLabel = '';
                this._ariaLabelledby = '';
                this._ariaDescribedby = '';
                this._ariaInvalid = '';
                this._ariaRequired = '';
                this._ariaReadonly = '';
                this._tabindex = null;
                this._autocomplete = '';
                this._spellcheck = null;
                this._maxlength = null;
                this._minlength = null;
                this._pattern = '';
                this._inputMode = '';
            }

            static get observedAttributes() {
                return [
                    'input-items', 'start-icon', 'start-text', 'end-icon', 'end-text',
                    'placeholder', 'description', 'alt-present', 'show-clear', 'error-message',
                    'variant', 'disabled', 'error', 'required', 'align', 'aria-label',
                    'aria-labelledby', 'aria-describedby', 'aria-invalid', 'aria-required',
                    'aria-readonly', 'tabindex', 'autocomplete', 'spellcheck', 'maxlength',
                    'minlength', 'pattern', 'inputmode'
                ];
            }

            connectedCallback() {
                this.render();
                this.setupAccessibility();
                this.setupEventListeners();
                this.initializeFieldValues();
            }

            attributeChangedCallback(name, oldValue, newValue) {
                if (oldValue !== newValue) {
                    this.updateAttribute(name, newValue);
                    this.render();
                    this.setupAccessibility();
                }
            }

            updateAttribute(name, value) {
                switch (name) {
                    case 'input-items':
                        try {
                            this._inputItems = value ? JSON.parse(value) : [];
                        } catch (e) {
                            this._inputItems = [];
                        }
                        break;
                    case 'start-icon':
                        this._startIcon = value || '';
                        break;
                    case 'start-text':
                        this._startText = value || '';
                        break;
                    case 'end-icon':
                        this._endIcon = value || '';
                        break;
                    case 'end-text':
                        this._endText = value || '';
                        break;
                    case 'placeholder':
                        this._placeholder = value || '';
                        break;
                    case 'description':
                        this._description = value || '';
                        break;
                    case 'alt-present':
                        this._altPresent = value || '';
                        break;
                    case 'show-clear':
                        this._showClear = value === 'true' || value === '';
                        break;
                    case 'error-message':
                        this._errorMessage = value || '';
                        break;
                    case 'variant':
                        this._variant = value || 'underline';
                        break;
                    case 'disabled':
                        this._disabled = value === 'true' || value === '';
                        break;
                    case 'error':
                        this._error = value === 'true' || value === '';
                        break;
                    case 'required':
                        this._required = value === 'true' || value === '';
                        break;
                    case 'align':
                        this._align = value || 'start';
                        break;
                    case 'aria-label':
                        this._ariaLabel = value || '';
                        break;
                    case 'aria-labelledby':
                        this._ariaLabelledby = value || '';
                        break;
                    case 'aria-describedby':
                        this._ariaDescribedby = value || '';
                        break;
                    case 'aria-invalid':
                        this._ariaInvalid = value || '';
                        break;
                    case 'aria-required':
                        this._ariaRequired = value === 'true' || value === '';
                        break;
                    case 'aria-readonly':
                        this._ariaReadonly = value || '';
                        break;
                    case 'tabindex':
                        this._tabindex = value ? (isNaN(value) ? value : parseInt(value)) : null;
                        break;
                    case 'autocomplete':
                        this._autocomplete = value || '';
                        break;
                    case 'spellcheck':
                        this._spellcheck = value === 'true' ? true : (value === 'false' ? false : null);
                        break;
                    case 'maxlength':
                        this._maxlength = value ? (isNaN(value) ? value : parseInt(value)) : null;
                        break;
                    case 'minlength':
                        this._minlength = value ? (isNaN(value) ? value : parseInt(value)) : null;
                        break;
                    case 'pattern':
                        this._pattern = value || '';
                        break;
                    case 'inputmode':
                        this._inputMode = value || '';
                        break;
                }
            }

            render() {
                const fieldClasses = this.getFieldClasses();
                const limitedInputItems = this._inputItems.slice(0, 4);
                
                this.shadowRoot.innerHTML = `
                    <style>
                        :host {
                            display: block;
                        }
                        
                        .sv-input-field {
                            display: flex;
                            flex-direction: column;
                            gap: 0.5rem;
                            width: 100%;
                        }

                        .sv-input-field__container {
                            display: flex;
                            gap: 0;
                            align-items: center;
                            width: 100%;
                        }

                        .sv-input-field__item-wrapper {
                            position: relative;
                            display: flex;
                            align-items: center;
                            flex: 1;
                            gap: 0.25rem;
                            padding: 0.75rem 1rem;
                            border: none;
                            background: transparent;
                            transition: all 0.2s ease-in-out;
                        }

                        .sv-input-field__item-group {
                            display: flex;
                            flex-direction: column;
                            flex: 1;
                            gap: 0.25rem;
                        }

                        .sv-input-field__item-alt-present {
                            font-size: 0.75rem;
                            line-height: 1.2;
                            color: #6b7280;
                            margin-top: 0.125rem;
                        }

                        .sv-input-field__item {
                            border: none;
                            outline: none;
                            background: transparent;
                            font-size: 1rem;
                            line-height: 1.5;
                            color: inherit;
                            flex: 1;
                            min-width: 0;
                        }

                        .sv-input-field__item::placeholder {
                            color: #9ca3af;
                        }

                        .sv-input-field__item--align-start {
                            text-align: start;
                        }

                        .sv-input-field__item--align-end {
                            text-align: end;
                        }

                        .sv-input-field__start-icon,
                        .sv-input-field__start-text {
                            flex-shrink: 0;
                            color: #6b7280;
                        }

                        .sv-input-field__start-text {
                            font-size: 1rem;
                            line-height: 1.5;
                        }

                        .sv-input-field__end-icon,
                        .sv-input-field__end-text {
                            flex-shrink: 0;
                            color: #6b7280;
                        }

                        .sv-input-field__end-text {
                            font-size: 1rem;
                            line-height: 1.5;
                        }

                        .sv-input-field__clear-button {
                            display: flex;
                            align-items: center;
                            justify-content: center;
                            padding: 0.25rem;
                            border: none;
                            background: transparent;
                            border-radius: 0.25rem;
                            cursor: pointer;
                            color: #6b7280;
                            transition: color 0.2s ease-in-out;
                        }

                        .sv-input-field__clear-button:hover {
                            color: #111827;
                        }

                        .sv-input-field__end-adornment,
                        .sv-input-field__button-slot {
                            flex-shrink: 0;
                        }

                        .sv-input-field__alt-present {
                            font-size: 0.875rem;
                            line-height: 1.25;
                            color: #6b7280;
                            margin-top: 0.25rem;
                        }

                        .sv-input-field__description {
                            font-size: 0.875rem;
                            line-height: 1.25;
                            color: #6b7280;
                        }

                        .sv-input-field__error-message {
                            font-size: 0.875rem;
                            line-height: 1.25;
                            color: #ef4444;
                        }

                        /* Variant styles */
                        .sv-input-field--variant-outline .sv-input-field__container {
                            border: 1px solid #d1d5db;
                            border-radius: 0.375rem;
                            background: #ffffff;
                        }

                        .sv-input-field--variant-outline .sv-input-field__container:focus-within {
                            border-color: #3b82f6;
                            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
                        }

                        .sv-input-field--variant-underline .sv-input-field__container {
                            border-bottom: 1px solid #d1d5db;
                            padding-bottom: 0.5rem;
                        }

                        .sv-input-field--variant-underline .sv-input-field__container:focus-within {
                            border-bottom-color: #3b82f6;
                        }

                        .sv-input-field--variant-underline .sv-input-field__item-wrapper {
                            padding-left: 0;
                            padding-right: 0;
                        }

                        /* State modifiers */
                        .sv-input-field--disabled {
                            opacity: 0.6;
                            pointer-events: none;
                        }

                        .sv-input-field--disabled.sv-input-field--variant-outline .sv-input-field__container {
                            background-color: #f3f4f6;
                        }

                        .sv-input-field--disabled .sv-input-field__item {
                            cursor: not-allowed;
                        }

                        .sv-input-field--error.sv-input-field--variant-outline .sv-input-field__container {
                            border-color: #ef4444;
                        }

                        .sv-input-field--error.sv-input-field--variant-outline .sv-input-field__container:focus-within {
                            border-color: #ef4444;
                            box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.1);
                        }

                        .sv-input-field--error.sv-input-field--variant-underline .sv-input-field__container {
                            border-bottom-color: #ef4444;
                        }

                        .sv-input-field--error.sv-input-field--variant-underline .sv-input-field__container:focus-within {
                            border-bottom-color: #ef4444;
                        }

                        .sv-input-field--required .sv-input-field__item-wrapper::after {
                            content: '*';
                            color: #ef4444;
                            margin-left: 0.25rem;
                        }

                        /* Responsive adjustments */
                        @media (max-width: 768px) {
                            .sv-input-field__container {
                                flex-direction: column;
                                gap: 0.75rem;
                            }
                        }

                        /* 접근성을 위한 포커스 스타일 */
                        .sv-input-field__item:focus-visible {
                            outline: 2px solid #3b82f6;
                            outline-offset: 2px;
                        }

                        .sv-input-field__clear-button:focus-visible {
                            outline: 2px solid #3b82f6;
                            outline-offset: 2px;
                        }

                        /* 고대비 모드 지원 */
                        @media (prefers-contrast: high) {
                            .sv-input-field__item {
                                border: 1px solid #000;
                            }
                            
                            .sv-input-field__clear-button {
                                border: 1px solid #000;
                            }
                        }

                        /* 모션 감소 지원 */
                        @media (prefers-reduced-motion: reduce) {
                            .sv-input-field__item-wrapper,
                            .sv-input-field__clear-button {
                                transition: none;
                            }
                        }

                        /* 슬롯 스타일 */
                        .sv-input-field__start-dropbox,
                        .sv-input-field__end-dropbox {
                            flex-shrink: 0;
                        }

                        /* 아이콘 스타일 */
                        .sv-input-field__start-icon,
                        .sv-input-field__end-icon {
                            display: flex;
                            align-items: center;
                            justify-content: center;
                            width: 1.5rem;
                            height: 1.5rem;
                        }
                    </style>
                    
                    <div class="${fieldClasses}">
                        <div class="sv-input-field__container">
                            ${this._startIcon ? `
                                <div class="sv-input-field__start-icon">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                        <use href="#icon-${this._startIcon}" />
                                    </svg>
                                </div>
                            ` : ''}

                            ${this._startText ? `
                                <span class="sv-input-field__start-text">${this._startText}</span>
                            ` : ''}

                            ${limitedInputItems.map(item => this.renderInputItem(item)).join('')}

                            ${this._endIcon ? `
                                <div class="sv-input-field__end-icon">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                        <use href="#icon-${this._endIcon}" />
                                    </svg>
                                </div>
                            ` : ''}

                            ${this._endText ? `
                                <span class="sv-input-field__end-text">${this._endText}</span>
                            ` : ''}
                        </div>

                        ${this._error && this._errorMessage ? `
                            <div class="sv-input-field__error-message" role="alert" aria-live="polite">
                                ${this._errorMessage}
                            </div>
                        ` : ''}

                        ${this._description && (!this._error || !this._errorMessage) ? `
                            <div class="sv-input-field__description">
                                ${this._description}
                            </div>
                        ` : ''}
                    </div>
                `;
            }

            renderInputItem(item) {
                const itemClasses = this.getItemClasses(item);
                const accessibilityAttributes = this.getAccessibilityAttributes(item.id);
                const hasValue = this._fieldValues[item.id] && this._fieldValues[item.id].length > 0;
                
                return `
                    <div class="sv-input-field__item-wrapper">
                        <div class="sv-input-field__item-group">
                            <input
                                id="${item.id}"
                                name="${item.name}"
                                type="${item.type}"
                                placeholder="${item.placeholder || this._placeholder}"
                                value="${this._fieldValues[item.id] || ''}"
                                ${this._disabled ? 'disabled' : ''}
                                ${this._autocomplete ? `autocomplete="${this._autocomplete}"` : ''}
                                ${this._spellcheck !== null ? `spellcheck="${this._spellcheck}"` : ''}
                                ${this._maxlength ? `maxlength="${this._maxlength}"` : ''}
                                ${this._minlength ? `minlength="${this._minlength}"` : ''}
                                ${this._pattern ? `pattern="${this._pattern}"` : ''}
                                ${this._inputMode ? `inputmode="${this._inputMode}"` : ''}
                                ${this._tabindex !== null ? `tabindex="${this._tabindex}"` : ''}
                                class="${itemClasses}"
                                ${accessibilityAttributes}
                            />

                            ${this._altPresent ? `
                                <div class="sv-input-field__item-alt-present">
                                    ${this._altPresent}
                                </div>
                            ` : ''}
                        </div>

                        ${this._showClear && hasValue ? `
                            <button
                                type="button"
                                class="sv-input-field__clear-button"
                                aria-label="Clear ${item.name}"
                                data-item-id="${item.id}"
                            >
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                                </svg>
                            </button>
                        ` : ''}
                    </div>
                `;
            }

            getFieldClasses() {
                const classes = ['sv-input-field'];
                
                if (this._variant) {
                    classes.push(`sv-input-field--variant-${this._variant}`);
                }
                
                if (this._disabled) {
                    classes.push('sv-input-field--disabled');
                }
                
                if (this._error) {
                    classes.push('sv-input-field--error');
                }
                
                if (this._required) {
                    classes.push('sv-input-field--required');
                }
                
                if (this._align) {
                    classes.push(`sv-input-field--align-${this._align}`);
                }
                
                return classes.join(' ');
            }

            getItemClasses(item) {
                const classes = ['sv-input-field__item'];
                
                if (item.type) {
                    classes.push(`sv-input-field__item--type-${item.type}`);
                }
                
                if (this._align) {
                    classes.push(`sv-input-field__item--align-${this._align}`);
                }
                
                return classes.join(' ');
            }

            getAccessibilityAttributes(itemId) {
                const attributes = [];
                
                if (this._ariaLabel) {
                    attributes.push(`aria-label="${this._ariaLabel}"`);
                }
                
                if (this._ariaLabelledby) {
                    attributes.push(`aria-labelledby="${this._ariaLabelledby}"`);
                }
                
                const describedByIds = [];
                if (this._description) {
                    describedByIds.push(`${itemId}-description`);
                }
                if (this._error && this._errorMessage) {
                    describedByIds.push(`${itemId}-error`);
                }
                if (describedByIds.length > 0) {
                    attributes.push(`aria-describedby="${describedByIds.join(' ')}"`);
                }
                
                if (this._ariaInvalid) {
                    attributes.push(`aria-invalid="${this._ariaInvalid}"`);
                } else if (this._error) {
                    attributes.push('aria-invalid="true"');
                }
                
                if (this._ariaRequired) {
                    attributes.push(`aria-required="${this._ariaRequired}"`);
                } else if (this._required) {
                    attributes.push('aria-required="true"');
                }
                
                if (this._ariaReadonly) {
                    attributes.push(`aria-readonly="${this._ariaReadonly}"`);
                }
                
                return attributes.join(' ');
            }

            setupAccessibility() {
                const inputs = this.shadowRoot.querySelectorAll('input');
                
                inputs.forEach(input => {
                    // 접근성 속성 설정
                    if (this._ariaLabel) {
                        input.setAttribute('aria-label', this._ariaLabel);
                    }
                    
                    if (this._ariaLabelledby) {
                        input.setAttribute('aria-labelledby', this._ariaLabelledby);
                    }
                    
                    // 상태에 따른 aria-invalid 설정
                    if (this._error) {
                        input.setAttribute('aria-invalid', 'true');
                    }
                    
                    // required 상태에 따른 aria-required 설정
                    if (this._required) {
                        input.setAttribute('aria-required', 'true');
                    }
                });
            }

            setupEventListeners() {
                const inputs = this.shadowRoot.querySelectorAll('input');
                const clearButtons = this.shadowRoot.querySelectorAll('.sv-input-field__clear-button');
                
                inputs.forEach(input => {
                    input.addEventListener('focus', (e) => this.handleFocus(e));
                    input.addEventListener('blur', (e) => this.handleBlur(e));
                    input.addEventListener('input', (e) => this.handleInput(e));
                    input.addEventListener('keydown', (e) => this.handleKeydown(e));
                });
                
                clearButtons.forEach(button => {
                    button.addEventListener('click', (e) => this.handleClear(e));
                });
            }

            initializeFieldValues() {
                this._inputItems.slice(0, 4).forEach(item => {
                    this._fieldValues[item.id] = item.defaultValue || '';
                });
            }

            handleFocus(event) {
                this._isFocused = true;
                this.dispatchEvent(new CustomEvent('focus', {
                    detail: { event },
                    bubbles: true,
                    composed: true
                }));
            }

            handleBlur(event) {
                this._isFocused = false;
                this.dispatchEvent(new CustomEvent('blur', {
                    detail: { event },
                    bubbles: true,
                    composed: true
                }));
            }

            handleInput(event) {
                const target = event.target;
                const itemId = target.id;
                
                this._fieldValues[itemId] = target.value;
                
                this.dispatchEvent(new CustomEvent('update:values', {
                    detail: { values: { ...this._fieldValues } },
                    bubbles: true,
                    composed: true
                }));
                
                this.dispatchEvent(new CustomEvent('input', {
                    detail: { event },
                    bubbles: true,
                    composed: true
                }));
                
                // 값이 변경되면 다시 렌더링하여 clear 버튼 표시/숨김 업데이트
                this.render();
                this.setupEventListeners();
            }

            handleKeydown(event) {
                // Enter 키로 폼 제출 시뮬레이션
                if (event.key === 'Enter') {
                    this.dispatchEvent(new CustomEvent('submit', {
                        detail: { event },
                        bubbles: true,
                        composed: true
                    }));
                }
            }

            handleClear(event) {
                const button = event.currentTarget;
                const itemId = button.getAttribute('data-item-id');
                
                if (itemId && this._fieldValues[itemId]) {
                    this._fieldValues[itemId] = '';
                    
                    // 입력 필드 값도 업데이트
                    const input = this.shadowRoot.querySelector(`#${itemId}`);
                    if (input) {
                        input.value = '';
                    }
                    
                    this.dispatchEvent(new CustomEvent('clear', {
                        detail: { itemId },
                        bubbles: true,
                        composed: true
                    }));
                    
                    this.dispatchEvent(new CustomEvent('update:values', {
                        detail: { values: { ...this._fieldValues } },
                        bubbles: true,
                        composed: true
                    }));
                    
                    // 다시 렌더링하여 clear 버튼 숨김
                    this.render();
                    this.setupEventListeners();
                }
            }

            // Getters and setters
            get inputItems() {
                return this._inputItems;
            }

            set inputItems(value) {
                this._inputItems = Array.isArray(value) ? value : [];
                this.setAttribute('input-items', JSON.stringify(value));
            }

            get values() {
                return { ...this._fieldValues };
            }

            set values(value) {
                this._fieldValues = { ...value };
                this.render();
            }

            get disabled() {
                return this._disabled;
            }

            set disabled(value) {
                this._disabled = value;
                this.setAttribute('disabled', value);
            }

            get error() {
                return this._error;
            }

            set error(value) {
                this._error = value;
                this.setAttribute('error', value);
            }

            get required() {
                return this._required;
            }

            set required(value) {
                this._required = value;
                this.setAttribute('required', value);
            }

            get variant() {
                return this._variant;
            }

            set variant(value) {
                this._variant = value;
                this.setAttribute('variant', value);
            }

            get align() {
                return this._align;
            }

            set align(value) {
                this._align = value;
                this.setAttribute('align', value);
            }

            // 접근성 관련 getter/setter
            get ariaLabel() {
                return this._ariaLabel;
            }

            set ariaLabel(value) {
                this._ariaLabel = value;
                this.setAttribute('aria-label', value);
            }

            get ariaInvalid() {
                return this._ariaInvalid;
            }

            set ariaInvalid(value) {
                this._ariaInvalid = value;
                this.setAttribute('aria-invalid', value);
            }

            get ariaRequired() {
                return this._ariaRequired;
            }

            set ariaRequired(value) {
                this._ariaRequired = value;
                this.setAttribute('aria-required', value);
            }
        }

        // 웹컴포넌트 등록
        customElements.define('sv-input-field', InputFieldComponent);
    </script>

    <!-- Animated Border Script -->
    <script src="../../../../script/components/input-field/animated-border.js"></script>

    <!-- 사용 예시 -->
    <h2>InputField 웹컴포넌트 사용 예시</h2>
    
    <h3>기본 InputField (Underline)</h3>
    <sv-input-field 
        input-items='[{"id":"name","name":"이름","type":"text","placeholder":"이름을 입력하세요"},{"id":"email","name":"이메일","type":"text","placeholder":"이메일을 입력하세요"}]'
        placeholder="기본 플레이스홀더"
        description="이름과 이메일을 입력해주세요"
    ></sv-input-field>
    
    <h3>Outline 스타일 InputField</h3>
    <sv-input-field 
        variant="outline"
        input-items='[{"id":"username","name":"사용자명","type":"text","placeholder":"사용자명을 입력하세요"},{"id":"password","name":"비밀번호","type":"password","placeholder":"비밀번호를 입력하세요"}]'
        start-icon="user"
        end-icon="lock"
        required="true"
        description="사용자 계정 정보를 입력해주세요"
    ></sv-input-field>
    
    <h3>시작/끝 텍스트가 있는 InputField</h3>
    <sv-input-field 
        input-items='[{"id":"amount","name":"금액","type":"text","placeholder":"금액을 입력하세요"}]'
        start-text="₩"
        end-text="원"
        variant="outline"
        description="금액을 입력해주세요"
    ></sv-input-field>
    
    <h3>에러 상태 InputField</h3>
    <sv-input-field 
        input-items='[{"id":"phone","name":"전화번호","type":"text","placeholder":"전화번호를 입력하세요"}]'
        error="true"
        error-message="올바른 전화번호 형식이 아닙니다"
        variant="outline"
        required="true"
    ></sv-input-field>
    
    <h3>비활성화된 InputField</h3>
    <sv-input-field 
        input-items='[{"id":"disabled","name":"비활성화","type":"text","value":"수정할 수 없음"}]'
        disabled="true"
        variant="outline"
        description="이 필드는 수정할 수 없습니다"
    ></sv-input-field>
    
    <h3>접근성 테스트</h3>
    <p>ARIA 라벨이 있는 InputField:</p>
    <sv-input-field 
        aria-label="검색 필드"
        input-items='[{"id":"search","name":"검색","type":"text","placeholder":"검색어를 입력하세요"}]'
        start-icon="search"
        variant="outline"
    ></sv-input-field>
    
    <p>설명이 있는 InputField:</p>
    <div id="inputfield-description">이 필드는 사용자 정보를 입력하는 곳입니다. 모든 항목은 필수입니다.</div>
    <sv-input-field 
        input-items='[{"id":"fullname","name":"전체이름","type":"text","placeholder":"전체 이름을 입력하세요"}]'
        aria-describedby="inputfield-description"
        variant="outline"
        required="true"
    ></sv-input-field>
    
    <h3>여러 입력 필드가 있는 InputField</h3>
    <sv-input-field 
        input-items='[{"id":"year","name":"년","type":"text","placeholder":"년도"},{"id":"month","name":"월","type":"text","placeholder":"월"},{"id":"day","name":"일","type":"text","placeholder":"일"}]'
        start-text="생년월일:"
        variant="outline"
        description="생년월일을 입력해주세요"
    ></sv-input-field>
    
    <h3>대체 표현이 있는 InputField</h3>
    <sv-input-field 
        input-items='[{"id":"temperature","name":"온도","type":"text","placeholder":"온도를 입력하세요"}]'
        alt-present="섭씨 온도"
        variant="outline"
        description="섭씨 온도를 입력해주세요"
    ></sv-input-field>

    <script>
        // 이벤트 리스너 예시
        document.addEventListener('update:values', (e) => {
            if (e.target.tagName === 'SV-INPUT-FIELD') {
                console.log('입력 값 변경:', e.detail.values);
            }
        });

        document.addEventListener('input', (e) => {
            if (e.target.tagName === 'SV-INPUT-FIELD') {
                console.log('입력 이벤트 발생');
            }
        });

        document.addEventListener('focus', (e) => {
            if (e.target.tagName === 'SV-INPUT-FIELD') {
                console.log('InputField 포커스');
            }
        });

        document.addEventListener('blur', (e) => {
            if (e.target.tagName === 'SV-INPUT-FIELD') {
                console.log('InputField 포커스 해제');
            }
        });

        document.addEventListener('clear', (e) => {
            if (e.target.tagName === 'SV-INPUT-FIELD') {
                console.log('값 클리어:', e.detail.itemId);
            }
        });

        document.addEventListener('submit', (e) => {
            if (e.target.tagName === 'SV-INPUT-FIELD') {
                console.log('Enter 키 입력');
            }
        });

        // 프로그래밍 방식으로 InputField 제어
        const inputField = document.querySelector('sv-input-field');
        if (inputField) {
            // 3초 후 값 설정
            setTimeout(() => {
                inputField.values = { name: '홍길동', email: 'hong@example.com' };
            }, 3000);
        }

        // 접근성 테스트를 위한 포커스 이벤트
        document.addEventListener('focusin', (e) => {
            if (e.target.tagName === 'SV-INPUT-FIELD') {
                console.log('InputField에 포커스됨');
            }
        });
    </script>
</body>
</html>
