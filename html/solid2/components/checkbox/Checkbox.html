<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checkbox Web Component</title>
    <style>
        /* Checkbox.module.scss의 내용을 웹컴포넌트용으로 변환 */
        @use "@/styles/shared" as *;

        /* Checkbox component */
        .sv-checkbox {
            position: relative;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
        }

        /* Input element */
        .sv-checkbox__input {
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            width: 24px;
            height: 24px;
            border-radius: 4px;
            border: 1px;
            border-style: solid;
            background-color: transparent;
            border-color: #ccc;
            outline: none;
        }

        .sv-checkbox__input__icon {
            display: inline-block;
            vertical-align: top;
            color: transparent;
            width: 18px;
            height: 18px;
        }

        /* Touch Area 추가 (40x40px) */
        .sv-checkbox__input::after {
            content: "";
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            display: block;
            width: 40px;
            height: 40px;
            background-color: rgba(0, 0, 0, 0);
        }

        /* Indicator element */
        .sv-checkbox__indicator {
            position: absolute;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            border-radius: 4px;
            border: 0;
        }

        .sv-checkbox__indicator__icon {
            color: transparent;
            width: 18px;
            height: 18px;
        }

        /* Label element */
        .sv-checkbox__label {
            color: #333;
            user-select: none;
            flex: 1;
            font-size: 14px;
            font-weight: 500;
        }

        .sv-checkbox--disabled .sv-checkbox__label {
            color: #999;
        }

        /* Type modifiers */
        .sv-checkbox--type-box .sv-checkbox__input[data-state="checked"] {
            border-color: #007bff;
        }

        .sv-checkbox--type-box .sv-checkbox__input .sv-checkbox__input__icon__unchecked {
            stroke: #666;
        }

        .sv-checkbox--type-box .sv-checkbox__indicator {
            top: 50%;
            left: 50%;
            width: 24px;
            height: 24px;
            margin-top: -12px;
            margin-left: -12px;
            animation: svCheckScale 0.25s ease forwards;
            background-color: #007bff;
        }

        .sv-checkbox--type-box .sv-checkbox__indicator .sv-checkbox__indicator__icon__checked {
            stroke: white;
            stroke-dasharray: 100%;
            stroke-dashoffset: 0;
            transition: stroke 0.4s ease forwards;
            animation: svCheckMark 0.4s ease forwards;
        }

        .sv-checkbox--type-box .sv-checkbox__indicator[data-disabled] {
            background-color: #ccc;
        }

        .sv-checkbox--type-box .sv-checkbox__input[data-disabled] {
            background-color: #f5f5f5;
            border-color: #ddd;
        }

        .sv-checkbox--type-box.sv-checkbox--disabled .sv-checkbox__input[data-disabled] .sv-checkbox__input__icon__unchecked {
            stroke: #f5f5f5;
        }

        .sv-checkbox--type-box.sv-checkbox--disabled .sv-checkbox__input[data-disabled] .sv-checkbox__indicator .sv-checkbox__indicator__icon__checked {
            stroke: #999;
        }

        /* Mark type */
        .sv-checkbox--type-mark .sv-checkbox__input {
            border: none;
            background: transparent;
        }

        .sv-checkbox--type-mark .sv-checkbox__input .sv-checkbox__input__icon__unchecked {
            stroke: #999;
        }

        .sv-checkbox--type-mark .sv-checkbox__indicator {
            background: transparent;
        }

        .sv-checkbox--type-mark .sv-checkbox__indicator .sv-checkbox__indicator__icon__checked {
            background: transparent;
            stroke: #007bff;
            stroke-dasharray: 100%;
            stroke-dashoffset: 0;
            transition: stroke 0.25s ease;
            animation: svCheckMark 0.25s ease;
        }

        .sv-checkbox--type-mark .sv-checkbox__input[data-disabled] .sv-checkbox__indicator__icon__checked {
            stroke: #ccc;
        }

        .sv-checkbox--type-mark .sv-checkbox__input[data-disabled] .sv-checkbox__indicator {
            border-color: transparent;
            background-color: transparent;
            stroke: #ccc;
        }

        .sv-checkbox--type-mark .sv-checkbox__input[data-disabled] .sv-checkbox__indicator .sv-checkbox__indicator__icon__checked {
            stroke: #ccc;
        }

        .sv-checkbox--type-mark.sv-checkbox--disabled .sv-checkbox__input[data-disabled] .sv-checkbox__input__icon__unchecked {
            stroke: #ccc;
        }

        .sv-checkbox--type-mark.sv-checkbox--disabled .sv-checkbox__input[data-disabled] .sv-checkbox__indicator {
            background: transparent;
        }

        .sv-checkbox--type-mark.sv-checkbox--disabled .sv-checkbox__input[data-disabled] .sv-checkbox__indicator .sv-checkbox__indicator__icon__checked {
            stroke: #ccc;
        }

        /* Alignment modifiers */
        .sv-checkbox--align-left {
            flex-direction: row;
        }

        .sv-checkbox--align-right {
            flex-direction: row-reverse;
        }

        /* State modifiers */
        .sv-checkbox--disabled {
            cursor: not-allowed;
            pointer-events: none;
        }

        .sv-checkbox--disabled .sv-checkbox__label {
            color: #999;
        }

        /* Focus styles */
        .sv-checkbox__input:focus-visible {
            outline: 2px solid #007bff;
            outline-offset: 2px;
        }

        /* Animations */
        @keyframes svCheckScale {
            from {
                transform: scale(0);
            }
            to {
                transform: scale(1);
            }
        }

        @keyframes svCheckMark {
            from {
                stroke-dashoffset: 100%;
            }
            to {
                stroke-dashoffset: 0;
            }
        }
    </style>
</head>
<body>
    <!-- 웹컴포넌트 정의 -->
    <script>
        class CheckboxComponent extends HTMLElement {
            constructor() {
                super();
                this.attachShadow({ mode: 'open' });
                this._checked = false;
                this._disabled = false;
                this._type = 'box';
                this._align = 'left';
                this._label = '';
                this._name = '';
                this._id = '';
            }

            static get observedAttributes() {
                return ['checked', 'disabled', 'type', 'align', 'label', 'name', 'id'];
            }

            connectedCallback() {
                this.render();
                this.setupEventListeners();
            }

            attributeChangedCallback(name, oldValue, newValue) {
                if (oldValue !== newValue) {
                    this.updateAttribute(name, newValue);
                    this.render();
                }
            }

            updateAttribute(name, value) {
                switch (name) {
                    case 'checked':
                        this._checked = value === 'true' || value === '';
                        break;
                    case 'disabled':
                        this._disabled = value === 'true' || value === '';
                        break;
                    case 'type':
                        this._type = value || 'box';
                        break;
                    case 'align':
                        this._align = value || 'left';
                        break;
                    case 'label':
                        this._label = value || '';
                        break;
                    case 'name':
                        this._name = value || '';
                        break;
                    case 'id':
                        this._id = value || this.generateId();
                        break;
                }
            }

            generateId() {
                return 'sv-checkbox-' + Math.random().toString(36).substr(2, 9);
            }

            render() {
                const containerClasses = this.getContainerClasses();
                
                this.shadowRoot.innerHTML = `
                    <style>
                        /* 여기에 위의 CSS 스타일을 복사 */
                        :host {
                            display: inline-block;
                        }
                        
                        .sv-checkbox {
                            position: relative;
                            display: inline-flex;
                            align-items: center;
                            gap: 8px;
                            cursor: pointer;
                        }

                        .sv-checkbox__input {
                            position: relative;
                            display: flex;
                            align-items: center;
                            justify-content: center;
                            flex-shrink: 0;
                            width: 24px;
                            height: 24px;
                            border-radius: 4px;
                            border: 1px solid #ccc;
                            background-color: transparent;
                            outline: none;
                            cursor: pointer;
                        }

                        .sv-checkbox__input:focus-visible {
                            outline: 2px solid #007bff;
                            outline-offset: 2px;
                        }

                        .sv-checkbox__input[data-state="checked"] {
                            border-color: #007bff;
                            background-color: #007bff;
                        }

                        .sv-checkbox__input[data-disabled] {
                            background-color: #f5f5f5;
                            border-color: #ddd;
                            cursor: not-allowed;
                        }

                        .sv-checkbox__input__icon {
                            display: inline-block;
                            vertical-align: top;
                            color: transparent;
                            width: 18px;
                            height: 18px;
                        }

                        .sv-checkbox__indicator {
                            position: absolute;
                            display: flex;
                            align-items: center;
                            justify-content: center;
                            flex-shrink: 0;
                            border-radius: 4px;
                            border: 0;
                        }

                        .sv-checkbox__indicator__icon {
                            color: white;
                            width: 18px;
                            height: 18px;
                        }

                        .sv-checkbox__label {
                            color: #333;
                            user-select: none;
                            flex: 1;
                            font-size: 14px;
                            font-weight: 500;
                        }

                        .sv-checkbox--disabled {
                            cursor: not-allowed;
                            pointer-events: none;
                        }

                        .sv-checkbox--disabled .sv-checkbox__label {
                            color: #999;
                        }

                        .sv-checkbox--align-left {
                            flex-direction: row;
                        }

                        .sv-checkbox--align-right {
                            flex-direction: row-reverse;
                        }

                        .sv-checkbox--type-box .sv-checkbox__indicator {
                            top: 50%;
                            left: 50%;
                            width: 24px;
                            height: 24px;
                            margin-top: -12px;
                            margin-left: -12px;
                            background-color: #007bff;
                        }

                        .sv-checkbox--type-mark .sv-checkbox__input {
                            border: none;
                            background: transparent;
                        }

                        .sv-checkbox--type-mark .sv-checkbox__indicator {
                            background: transparent;
                        }

                        .sv-checkbox--type-mark .sv-checkbox__indicator__icon {
                            color: #007bff;
                        }
                    </style>
                    
                    <div class="${containerClasses}">
                        <div 
                            class="sv-checkbox__input" 
                            role="checkbox"
                            aria-checked="${this._checked}"
                            aria-disabled="${this._disabled}"
                            data-state="${this._checked ? 'checked' : 'unchecked'}"
                            data-disabled="${this._disabled}"
                            tabindex="${this._disabled ? '-1' : '0'}"
                        >
                            <svg class="sv-checkbox__input__icon" width="18" height="18" viewBox="0 0 18 18" fill="none">
                                <path
                                    class="sv-checkbox__input__icon__unchecked"
                                    d="M3.375 8.625L7.125 12.375L14.625 4.875"
                                    stroke="currentColor"
                                    stroke-width="1.6875"
                                ></path>
                            </svg>

                            ${this._checked ? `
                                <div class="sv-checkbox__indicator">
                                    <svg
                                        class="sv-checkbox__indicator__icon"
                                        width="18"
                                        height="18"
                                        viewBox="0 0 18 18"
                                        fill="none"
                                    >
                                        <path
                                            class="sv-checkbox__indicator__icon__checked"
                                            d="M3.375 8.625L7.125 12.375L14.625 4.875"
                                            stroke="currentColor"
                                            stroke-width="2.8125"
                                            stroke-dasharray="100%"
                                            stroke-dashoffset="0"
                                        ></path>
                                    </svg>
                                </div>
                            ` : ''}
                        </div>

                        ${this._label ? `
                            <div class="sv-checkbox__label">
                                <label for="${this._id}">${this._label}</label>
                            </div>
                        ` : ''}
                    </div>
                `;
            }

            getContainerClasses() {
                const classes = ['sv-checkbox'];
                
                if (this._type) {
                    classes.push(`sv-checkbox--type-${this._type}`);
                }
                
                if (this._align) {
                    classes.push(`sv-checkbox--align-${this._align}`);
                }
                
                if (this._disabled) {
                    classes.push('sv-checkbox--disabled');
                }
                
                if (this._checked) {
                    classes.push('sv-checkbox--checked');
                }
                
                return classes.join(' ');
            }

            setupEventListeners() {
                const input = this.shadowRoot.querySelector('.sv-checkbox__input');
                
                if (input) {
                    input.addEventListener('click', (e) => {
                        if (!this._disabled) {
                            this.toggle();
                        }
                    });

                    input.addEventListener('keydown', (e) => {
                        if (e.key === 'Enter' || e.key === ' ') {
                            e.preventDefault();
                            if (!this._disabled) {
                                this.toggle();
                            }
                        }
                    });
                }
            }

            toggle() {
                this._checked = !this._checked;
                this.setAttribute('checked', this._checked);
                this.dispatchEvent(new CustomEvent('change', {
                    detail: { checked: this._checked },
                    bubbles: true,
                    composed: true
                }));
                this.render();
            }

            // Getters and setters
            get checked() {
                return this._checked;
            }

            set checked(value) {
                this._checked = value;
                this.setAttribute('checked', value);
            }

            get disabled() {
                return this._disabled;
            }

            set disabled(value) {
                this._disabled = value;
                this.setAttribute('disabled', value);
            }

            get type() {
                return this._type;
            }

            set type(value) {
                this._type = value;
                this.setAttribute('type', value);
            }

            get align() {
                return this._align;
            }

            set align(value) {
                this._align = value;
                this.setAttribute('align', value);
            }

            get label() {
                return this._label;
            }

            set label(value) {
                this._label = value;
                this.setAttribute('label', value);
            }
        }

        // 웹컴포넌트 등록
        customElements.define('sv-checkbox', CheckboxComponent);
    </script>

    <!-- 사용 예시 -->
    <h2>Checkbox 웹컴포넌트 사용 예시</h2>
    
    <h3>기본 체크박스</h3>
    <sv-checkbox label="기본 체크박스"></sv-checkbox>
    
    <h3>체크된 체크박스</h3>
    <sv-checkbox label="체크된 체크박스" checked></sv-checkbox>
    
    <h3>비활성화된 체크박스</h3>
    <sv-checkbox label="비활성화된 체크박스" disabled></sv-checkbox>
    
    <h3>Mark 타입 체크박스</h3>
    <sv-checkbox label="Mark 타입 체크박스" type="mark"></sv-checkbox>
    
    <h3>우측 정렬 체크박스</h3>
    <sv-checkbox label="우측 정렬 체크박스" align="right"></sv-checkbox>
    
    <h3>체크박스 그룹</h3>
    <div>
        <sv-checkbox label="옵션 1" name="group1"></sv-checkbox>
        <sv-checkbox label="옵션 2" name="group1"></sv-checkbox>
        <sv-checkbox label="옵션 3" name="group1"></sv-checkbox>
    </div>

    <script>
        // 이벤트 리스너 예시
        document.addEventListener('change', (e) => {
            if (e.target.tagName === 'SV-CHECKBOX') {
                console.log('체크박스 상태 변경:', e.target.checked);
            }
        });

        // 프로그래밍 방식으로 체크박스 제어
        const checkbox = document.querySelector('sv-checkbox');
        if (checkbox) {
            // 3초 후 체크
            setTimeout(() => {
                checkbox.checked = true;
            }, 3000);
        }
    </script>
</body>
</html>
