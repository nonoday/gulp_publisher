<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="theme-color" content="#ffffff">
    <title>Accordion Web Component</title>
    <style>
        /* CSS ë³€ìˆ˜ ì •ì˜ */
        :root {
            --ease: cubic-bezier(0.4, 0, 0.2, 1);
            --spacing-sm: 8px;
            --spacing-md: 16px;
            --spacing-lg: 20px;
            --spacing-xl: 24px;
            --spacing-2xl: 32px;
            --spacing-3xl: 48px;
            --radius-xl: 12px;
            --text-secondary: #666;
            --text-disabled-same: #999;
            --fg-quaternary: #999;
            --fg-disabled: #ccc;
            --border-secondary: #e0e0e0;
            --border-disabled: #f0f0f0;
            --bg-graylight: #f8f9fa;
            --bg-disabled: #f5f5f5;
        }

        /* ì›¹ì»´í¬ë„ŒíŠ¸ ê¸°ë³¸ ìŠ¤íƒ€ì¼ */
        accordion-list, accordion-item {
            display: block;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }



        /* ê¸°ë³¸ ë ˆì´ì•„ì›ƒ */
        body {
            margin: 0;
            padding: 20px;
            background-color: #fafafa;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
    </style>
</head>
<body>
    <!-- Basic Accordion ì»´í¬ë„ŒíŠ¸ ì‚¬ìš© ì˜ˆì‹œ -->
    <accordion-list variant="basic">
        <accordion-item>
            <div slot="icon">ğŸ“‹</div>
            <div slot="title">ì²« ë²ˆì§¸ ì•„ì½”ë””ì–¸</div>
            <div slot="content">
                <p>ì²« ë²ˆì§¸ ì•„ì½”ë””ì–¸ì˜ ë‚´ìš©ì…ë‹ˆë‹¤. ì—¬ê¸°ì— ìƒì„¸í•œ ì •ë³´ë¥¼ í‘œì‹œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
            </div>
        </accordion-item>

        <accordion-item>
            <div slot="icon">âš™ï¸</div>
            <div slot="title">ë‘ ë²ˆì§¸ ì•„ì½”ë””ì–¸</div>
            <div slot="content">
                <p>ë‘ ë²ˆì§¸ ì•„ì½”ë””ì–¸ì˜ ë‚´ìš©ì…ë‹ˆë‹¤. ì„¤ì •ì´ë‚˜ ì˜µì…˜ ì •ë³´ë¥¼ í‘œì‹œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
            </div>
        </accordion-item>

        <accordion-item>
            <div slot="icon">ğŸ“Š</div>
            <div slot="title">ì„¸ ë²ˆì§¸ ì•„ì½”ë””ì–¸</div>
            <div slot="content">
                <p>ì„¸ ë²ˆì§¸ ì•„ì½”ë””ì–¸ì˜ ë‚´ìš©ì…ë‹ˆë‹¤. ì°¨íŠ¸ë‚˜ í†µê³„ ì •ë³´ë¥¼ í‘œì‹œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
            </div>
        </accordion-item>
    </accordion-list>

    <!-- Solid Accordion ì»´í¬ë„ŒíŠ¸ ì‚¬ìš© ì˜ˆì‹œ -->
    <accordion-list variant="solid" style="margin-top: 40px;">
        <accordion-item>
            <div slot="icon">ğŸ¨</div>
            <div slot="title">Solid ìŠ¤íƒ€ì¼ ì•„ì½”ë””ì–¸</div>
            <div slot="content">
                <p>Solid ë³€í˜• ìŠ¤íƒ€ì¼ì˜ ì•„ì½”ë””ì–¸ì…ë‹ˆë‹¤. ë°°ê²½ìƒ‰ê³¼ ë‘¥ê·¼ ëª¨ì„œë¦¬ë¥¼ ê°€ì§‘ë‹ˆë‹¤.</p>
            </div>
        </accordion-item>
    </accordion-list>

    <script>
        class AccordionItem extends HTMLElement {
            constructor() {
                super();
                this.isOpen = false;
                this.isDisabled = false;
                this.destroyOnClose = false;
                this.uniqueId = `accordion-${Math.random().toString(36).substring(2, 9)}`;
                this.panelId = `${this.uniqueId}-panel`;
                this.triggerId = `${this.uniqueId}-trigger`;
                
                this.attachShadow({ mode: 'open' });
                this.render();
                this.init();
            }

            render() {
                this.shadowRoot.innerHTML = `
                    <style>
                        :host {
                            display: block;
                            position: relative;
                        }
                        
                        :host([variant="basic"]) {
                            border-bottom: 1px solid #e0e0e0;
                        }
                        
                        :host([variant="solid"]) {
                            background-color: #f8f9fa;
                            border-radius: 12px;
                            margin-bottom: 24px;
                        }
                        
                        .accordion-header {
                            display: flex;
                            align-items: center;
                            width: 100%;
                            padding: 32px;
                            text-align: left;
                            cursor: pointer;
                            text-decoration: none;
                            color: inherit;
                            border: none;
                            background: none;
                            font-family: inherit;
                            font-size: inherit;
                            -webkit-tap-highlight-color: transparent;
                            touch-action: manipulation;
                            user-select: none;
                        }
                        
                        .accordion-header:active {
                            background-color: rgba(0, 0, 0, 0.05);
                            transform: scale(0.98);
                            transition: all 0.1s ease;
                        }
                        
                        .accordion-title {
                            display: flex;
                            align-items: center;
                            width: 100%;
                            flex: 1;
                            font-size: 18px;
                            font-weight: 500;
                            color: #666;
                            word-break: break-all;
                            flex-wrap: wrap;
                        }
                        
                        ::slotted([slot="title"]) {
                            font-size: 18px;
                            font-weight: 500;
                            color: #666;
                        }
                        
                        .accordion-icon {
                            flex-shrink: 0;
                            margin-right: 16px;
                            width: 28px;
                            height: 28px;
                        }
                        
                        ::slotted([slot="icon"]) {
                            width: 28px;
                            height: 28px;
                            display: inline-block;
                            font-size: 24px;
                            line-height: 1;
                        }
                        
                        .accordion-chevron {
                            flex-shrink: 0;
                            display: flex;
                            align-items: center;
                            justify-content: center;
                            color: #999;
                            margin-left: 16px;
                            transition: transform 0.25s cubic-bezier(0.4, 0, 0.2, 1);
                            cursor: pointer;
                            width: 20px;
                            height: 20px;
                        }
                        
                        .accordion-chevron.rotated {
                            transform: rotate(180deg);
                        }
                        
                        .accordion-panel {
                            position: relative;
                            display: none;
                            overflow: hidden;
                            transition: height 0.25s cubic-bezier(0.4, 0, 0.2, 1);
                        }
                        
                        .accordion-panel.open {
                            display: block;
                        }
                        
                        .accordion-content {
                            padding: 16px 32px 48px;
                        }
                        
                        ::slotted([slot="content"]) {
                            margin: 0;
                            line-height: 1.6;
                        }
                        
                        ::slotted([slot="content"]) p {
                            margin: 0 0 16px 0;
                        }
                        
                        .chevron-down {
                            width: 20px;
                            height: 20px;
                            border: solid #999;
                            border-width: 0 2px 2px 0;
                            display: inline-block;
                            padding: 3px;
                            transform: rotate(45deg);
                        }
                        
                        .chevron-down.rotated {
                            transform: rotate(-135deg);
                        }
                        

                        
                        @media (max-width: 768px) {
                            .accordion-header {
                                padding: 24px;
                                min-height: 48px;
                            }
                            
                            .accordion-title {
                                font-size: 16px;
                            }
                            
                            .accordion-chevron {
                                min-width: 44px;
                                min-height: 44px;
                            }
                            
                            .accordion-content {
                                padding: 20px 24px;
                                font-size: 14px;
                                line-height: 1.6;
                            }
                        }
                        
                        :host([disabled]) .accordion-header {
                            background-color: #f5f5f5;
                            cursor: not-allowed;
                        }
                        
                        :host([disabled]) .accordion-title {
                            color: #ccc;
                        }
                    </style>
                    
                    <button class="accordion-header" role="button" aria-expanded="false">
                        <div class="accordion-title">
                            <div class="accordion-icon">
                                <slot name="icon"></slot>
                            </div>
                            <div class="title-text">
                                <slot name="title"></slot>
                            </div>
                        </div>
                        <div class="accordion-chevron" title="ìƒì„¸ë³´ê¸°">
                            <div class="chevron-down"></div>
                        </div>
                    </button>
                    <div class="accordion-panel" role="region" aria-hidden="true">
                        <div class="accordion-content">
                            <slot name="content"></slot>
                        </div>
                    </div>
                `;
            }

            init() {
                this.header = this.shadowRoot.querySelector('.accordion-header');
                this.panel = this.shadowRoot.querySelector('.accordion-panel');
                this.icon = this.shadowRoot.querySelector('.accordion-chevron .chevron-down');
                
                // ë¶€ëª¨ accordion-listì˜ variantë¥¼ ê°€ì ¸ì™€ì„œ ì„¤ì •
                const parentList = this.closest('accordion-list');
                if (parentList) {
                    const variant = parentList.getAttribute('variant') || 'basic';
                    this.setAttribute('variant', variant);
                }
                
                if (this.header && this.panel) {
                    this.setupEventListeners();
                    this.updateAttributes();
                }
            }

            setupEventListeners() {
                // í´ë¦­ ì´ë²¤íŠ¸
                this.header.addEventListener('click', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    this.toggle();
                });

                // ì•„ì´ì½˜ í´ë¦­ ì´ë²¤íŠ¸ (í—¤ë”ì™€ ë³„ë„ë¡œ ì²˜ë¦¬)
                if (this.icon) {
                    this.icon.addEventListener('click', (e) => {
                        e.preventDefault();
                        e.stopPropagation();
                        this.toggle();
                    });
                }

                // ëª¨ë°”ì¼ í„°ì¹˜ ì´ë²¤íŠ¸
                this.setupTouchEvents();
                
                // í‚¤ë³´ë“œ ì ‘ê·¼ì„±
                this.setupKeyboardEvents();
            }

            setupTouchEvents() {
                let startY = 0;
                let startTime = 0;
                let isSwiping = false;

                // í„°ì¹˜ ì‹œì‘
                this.header.addEventListener('touchstart', (e) => {
                    startY = e.touches[0].clientY;
                    startTime = Date.now();
                    isSwiping = false;
                }, { passive: true });

                // í„°ì¹˜ ì´ë™
                this.header.addEventListener('touchmove', (e) => {
                    if (!isSwiping) {
                        const deltaY = Math.abs(e.touches[0].clientY - startY);
                        if (deltaY > 10) {
                            isSwiping = true;
                        }
                    }
                }, { passive: true });

                // í„°ì¹˜ ì¢…ë£Œ
                this.header.addEventListener('touchend', (e) => {
                    const endTime = Date.now();
                    const duration = endTime - startTime;
                    
                    // ë¹ ë¥¸ íƒ­ (300ms ì´í•˜) ë˜ëŠ” ìŠ¤ì™€ì´í”„ê°€ ì•„ë‹Œ ê²½ìš°ì—ë§Œ í† ê¸€
                    if (duration < 300 && !isSwiping) {
                        e.preventDefault();
                        this.toggle();
                    }
                });

                // ë”ë¸” íƒ­ìœ¼ë¡œ ì—´ê¸°/ë‹«ê¸°
                let lastTap = 0;
                this.header.addEventListener('touchend', (e) => {
                    const currentTime = new Date().getTime();
                    const tapLength = currentTime - lastTap;
                    
                    if (tapLength < 500 && tapLength > 0) {
                        // ë”ë¸” íƒ­ ê°ì§€
                        e.preventDefault();
                        this.toggle();
                    }
                    lastTap = currentTime;
                });
            }

            setupKeyboardEvents() {
                this.header.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter' || e.key === ' ' || e.key === 'Spacebar') {
                        e.preventDefault();
                        this.toggle();
                    }
                });
            }

            toggle() {
                if (this.isDisabled) return;

                this.isOpen = !this.isOpen;
                this.updateState();
                this.updateAttributes();
                this.animatePanel();
                
                // ëª¨ë°”ì¼ í–…í‹± í”¼ë“œë°±
                this.triggerHapticFeedback();
                
                // ì»¤ìŠ¤í…€ ì´ë²¤íŠ¸ ë°œìƒ
                this.dispatchEvent(new CustomEvent('accordionChange', {
                    detail: { isOpen: this.isOpen }
                }));
            }

            triggerHapticFeedback() {
                // ëª¨ë°”ì¼ì—ì„œ í–…í‹± í”¼ë“œë°± ì œê³µ
                if ('vibrate' in navigator) {
                    navigator.vibrate(50); // ì§§ì€ ì§„ë™
                }
                
                // iOSì—ì„œ í–…í‹± í”¼ë“œë°±
                if (window.webkit && window.webkit.messageHandlers) {
                    try {
                        window.webkit.messageHandlers.hapticFeedback.postMessage('light');
                    } catch (e) {
                        // iOS ë„¤ì´í‹°ë¸Œ ì•±ì´ ì•„ë‹Œ ê²½ìš° ë¬´ì‹œ
                    }
                }
            }

            updateState() {
                this.setAttribute('data-state', this.isOpen ? 'open' : 'closed');
                
                if (this.icon) {
                    if (this.isOpen) {
                        this.icon.classList.add('rotated');
                    } else {
                        this.icon.classList.remove('rotated');
                    }
                }

                if (this.panel) {
                    if (this.isOpen) {
                        this.panel.classList.add('open');
                    } else {
                        this.panel.classList.remove('open');
                    }
                }
            }

            updateAttributes() {
                if (this.header) {
                    this.header.setAttribute('aria-expanded', this.isOpen);
                    this.header.setAttribute('aria-controls', this.panelId);
                    this.header.id = this.triggerId;
                }

                if (this.panel) {
                    this.panel.id = this.panelId;
                    this.panel.setAttribute('aria-labelledby', this.triggerId);
                    this.panel.setAttribute('aria-hidden', !this.isOpen);
                }
            }

            animatePanel() {
                if (!this.panel) return;

                if (this.isOpen) {
                    this.slideDown();
                } else {
                    this.slideUp();
                }
            }

            slideDown() {
                this.panel.style.display = 'block';
                this.panel.style.height = '0px';
                this.panel.style.overflow = 'hidden';

                requestAnimationFrame(() => {
                    const height = this.panel.scrollHeight;
                    this.panel.style.height = `${height}px`;
                });

                const cleanup = () => {
                    this.panel.style.height = '';
                    this.panel.style.overflow = '';
                    this.panel.removeEventListener('transitionend', cleanup);
                };

                this.panel.addEventListener('transitionend', cleanup);
            }

            slideUp() {
                const height = this.panel.scrollHeight;
                this.panel.style.height = `${height}px`;
                this.panel.style.overflow = 'hidden';

                requestAnimationFrame(() => {
                    this.panel.style.height = '0px';
                });

                const cleanup = () => {
                    this.panel.style.display = 'none';
                    this.panel.style.height = '';
                    this.panel.style.overflow = '';
                    this.panel.removeEventListener('transitionend', cleanup);
                };

                this.panel.addEventListener('transitionend', cleanup);
            }

            // ê³µê°œ ë©”ì„œë“œë“¤
            open() {
                if (!this.isOpen) {
                    this.toggle();
                }
            }

            close() {
                if (this.isOpen) {
                    this.toggle();
                }
            }

            setDisabled(disabled) {
                this.isDisabled = disabled;
                this.setAttribute('disabled', disabled);
                this.header.setAttribute('aria-disabled', disabled);
                
                if (disabled) {
                    this.header.style.cursor = 'not-allowed';
                } else {
                    this.header.style.cursor = 'pointer';
                }
            }
        }

        class AccordionList extends HTMLElement {
            constructor() {
                super();
                this.items = [];
                this.variant = 'basic';
                this.disabled = false;
                this.allowMultiple = false;
                
                this.attachShadow({ mode: 'open' });
                this.render();
                this.init();
            }

            render() {
                this.shadowRoot.innerHTML = `
                    <style>
                        :host {
                            display: flex;
                            flex-direction: column;
                            width: 100%;
                        }
                        
                        :host([variant="solid"]) ::slotted(accordion-item) {
                            margin-bottom: 24px;
                        }
                        
                        ::slotted(accordion-item) {
                            display: block;
                        }
                    </style>
                    <slot></slot>
                `;
            }

            init() {
                this.items = Array.from(this.querySelectorAll('accordion-item'));
                this.variant = this.getAttribute('variant') || 'basic';
                this.disabled = this.hasAttribute('disabled');
                this.allowMultiple = this.hasAttribute('allow-multiple');
                
                this.setupAccordion();
            }

            setupAccordion() {
                this.items.forEach((item, index) => {
                    // ê° ì•„ì´í…œì— value ì†ì„± ì„¤ì •
                    item.setAttribute('data-value', index.toString());
                    
                    // ì•„ì½”ë””ì–¸ ë³€ê²½ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
                    item.addEventListener('accordionChange', (e) => {
                        if (!this.allowMultiple && e.detail.isOpen) {
                            // ë‹¨ì¼ ì„ íƒ ëª¨ë“œì¼ ë•Œ ë‹¤ë¥¸ ì•„ì´í…œë“¤ ë‹«ê¸°
                            this.closeOtherItems(index);
                        }
                    });
                });
            }

            closeOtherItems(openIndex) {
                this.items.forEach((item, index) => {
                    if (index !== openIndex) {
                        if (item.isOpen) {
                            item.close();
                        }
                    }
                });
            }

            // ê³µê°œ ë©”ì„œë“œë“¤
            openItem(value) {
                const item = this.items.find(item => item.getAttribute('data-value') === value.toString());
                if (item) {
                    item.open();
                }
            }

            closeItem(value) {
                const item = this.items.find(item => item.getAttribute('data-value') === value.toString());
                if (item) {
                    item.close();
                }
            }

            isItemOpen(value) {
                const item = this.items.find(item => item.getAttribute('data-value') === value.toString());
                return item ? item.isOpen : false;
            }

            setDisabled(disabled) {
                this.disabled = disabled;
                this.items.forEach(item => {
                    item.setDisabled(disabled);
                });
            }
        }

        // ì»¤ìŠ¤í…€ ì—˜ë¦¬ë¨¼íŠ¸ ë“±ë¡
        customElements.define('accordion-item', AccordionItem);
        customElements.define('accordion-list', AccordionList);




    </script>


</body>
</html>
